<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Book Room - StayFind</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <header class="bg-blue-700 text-white py-4">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
      <h1 class="text-xl font-bold">StayFind</h1>
      <a href="room_listings.html" class="text-white hover:text-gray-200">Back to Listings</a>
    </div>
  </header>

  <section class="max-w-3xl mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg">
    <h2 class="text-3xl font-semibold text-center text-blue-600 mb-6">Book Your Stay</h2>

    <form id="bookingForm">
      <div class="mb-4">
        <label for="checkin" class="block text-sm font-medium text-gray-700">Check-in Date</label>
        <input type="date" id="checkin" name="checkin" class="w-full px-4 py-2 mt-2 border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="checkout" class="block text-sm font-medium text-gray-700">Check-out Date</label>
        <input type="date" id="checkout" name="checkout" class="w-full px-4 py-2 mt-2 border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="guests" class="block text-sm font-medium text-gray-700">Number of Guests</label>
        <input type="number" id="guests" name="guests" class="w-full px-4 py-2 mt-2 border border-gray-300 rounded-md" required />
      </div>

      <div class="mb-4">
        <label for="paymentMethod" class="block text-sm font-medium text-gray-700">Payment Method</label>
        <select id="paymentMethod" name="paymentMethod" class="w-full px-4 py-2 mt-2 border border-gray-300 rounded-md">
          <option value="gcash">GCash</option>
          <option value="paymaya">PayMaya</option>
          <option value="banktransfer">Bank Transfer</option>
        </select>
      </div>

      <div class="text-center mt-6">
        <button type="submit" class="w-full py-2 px-4 bg-blue-600 text-white text-lg font-semibold rounded-md hover:bg-blue-700 transition">Confirm Booking</button>
      </div>
    </form>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('bookingForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const checkin = document.getElementById('checkin').value;
        const checkout = document.getElementById('checkout').value;
        const guests = document.getElementById('guests').value;
        const paymentMethod = document.getElementById('paymentMethod').value;

        // Get room_id from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const roomId = urlParams.get('room_id');

        const formData = new FormData();
        formData.append('checkin', checkin);
        formData.append('checkout', checkout);
        formData.append('guests', guests);
        formData.append('paymentMethod', paymentMethod);
        formData.append('room_id', roomId);

        try {
          const response = await fetch('../api/bookings.php', {
            method: 'POST',
            body: formData
          });

          const result = await response.json();
          alert(result.message);
        } catch (error) {
          console.error('Error:', error);
          alert('Error booking your stay, please try again.');
        }
      });
    });
  </script>

</body>
</html>
